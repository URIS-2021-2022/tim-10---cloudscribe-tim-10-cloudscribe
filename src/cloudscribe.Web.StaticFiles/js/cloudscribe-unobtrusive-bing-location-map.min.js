function loadMapScenario(){for(var e=document.querySelectorAll("[data-bing-map]"),a=0;a<e.length;a++){var t=e[a]
window.cloudscribeUnotrusiveBingMap.buildMap(t)}}window.cloudscribeUnotrusiveBingMap={mapItems:[],buildMap:function(e){var a={}
a.map=new Microsoft.Maps.Map(e,{}),a.fromAddressElement=document.getElementById(e.dataset.fromAddressElementId),a.btnGetDirections=document.getElementById(e.dataset.getDirectionsButtonId),a.btnGetDirections.onclick=function(){if(a.fromAddressElement.value){var e={bounds:a.map.getBounds(),where:a.fromAddressElement.value,callback:a.getDirectionsCallback}
a.searchManager.geocode(e)}},a.getDirectionsCallback=function(t,o){var n=t.results[0],i=new Microsoft.Maps.Directions.Waypoint({address:n.name,location:n.location})
a.directionsManager.addWaypoint(i)
var s=new Microsoft.Maps.Directions.Waypoint({address:e.dataset.locationTitle,location:a.geoResult.location})
a.directionsManager.addWaypoint(s),a.directionsManager.setRenderOptions({itineraryContainer:document.getElementById(e.dataset.itineraryElementId)}),a.directionsManager.calculateDirections()},a.searchCallback=function(e,t){a.geoResult=e.results[0],a.map.setView({bounds:a.geoResult.bestView}),a.map.entities.push(new Microsoft.Maps.Pushpin(a.geoResult.location)),Microsoft.Maps.loadModule("Microsoft.Maps.Directions",function(){a.directionsManager=new Microsoft.Maps.Directions.DirectionsManager(a.map),a.directionsManager.setRequestOptions({routeMode:Microsoft.Maps.Directions.RouteMode.driving})})},a.initSearch=function(){var t={bounds:a.map.getBounds(),where:e.dataset.address,callback:a.searchCallback}
a.searchManager.geocode(t)},Microsoft.Maps.loadModule("Microsoft.Maps.Search",function(){a.searchManager=new Microsoft.Maps.Search.SearchManager(a.map),a.initSearch()}),this.mapItems.push(a)}}
